<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0.1//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="author" content="">
<link media="screen" type="text/css" rel="stylesheet" href=".././css/apache.css">
<link media="print" type="text/css" rel="stylesheet" href=".././css/print.css">
<title>Public API/SPI vs internal classes</title>
</head>
<body>
<table width="100%" cellspacing="0" id="header">
<tr>
<td id="projectLogo" class="logo"><a href="http://jakarta.apache.org/"><img alt="The Apache Jakarta Project" src=".././images/jakarta-logo.gif"></a></td><td id="subprojectLogo" class="logo"><a href="http://jakarta.apache.org/cactus/"><img alt="Public API/SPI vs internal classes" src=".././images/logocactus.gif"></a></td>
</tr>
<tr id="contextBar">
<td id="breadCrumbs"><a href="http://www.apache.org/">Apache</a> &gt; <a href="http://jakarta.apache.org/">Jakarta</a> &gt; <a href=".././index.html">Cactus</a> &gt; <a href=".././participating/index.html">Participating</a></td><td id="status">
              Docs for:
              <strong>v1.7.2</strong> | <a href=".././..">v1.7</a>
              &nbsp;&nbsp;
              Last update: March 26 2006</td>
</tr>
</table>
<table id="main">
<tr>
<td id="sidebar">
<div id="navigation">
<ul>

  
<li>
<a href=".././index.html" title="Describes what the Cactus framework is, defines several types of unit tests and explains which are best implemented with Cactus.">Main Page</a>
<ul></ul>
</li>

  
<li>Participating<ul>
    
<li>
<a href=".././participating/index.html" title="Information on participating in the development of Cactus.">Introduction</a>
</li>
    
<li>
<a href=".././participating/contributors.html" title="Lists people who are or have been contributing to Cactus.">Contributors</a>
</li>
    
<li>
<a href=".././participating/users.html" title="Informal list about who is using Cactus.">Who Uses Cactus?</a>
</li>
  
</ul>
</li>

  
<li>Developers<ul>
    
<li>
<a target="bug_database_cactus_open_issues" href="http://issues.apache.org/jira/browse/CACTUS?report=com.atlassian.jira.plugin.system.project:openissues-panel">Todo/Open Issues</a>
</li>
    
<li>
<a href=".././participating/build_result.html" title="Aggregated links to the results of the nightly builds.">Nightly Build Results</a>
</li>
    
<li>
<a href=".././participating/coding_conventions.html" title="The coding conventions used for the development of Cactus itself.">Coding Conventions</a>
</li>
    
<li>
<a href=".././participating/apis.html" title="Explains how the Cactus project differentiates between public API/SPI and internal implementation classes." class="currentPage">Public API/SPIs</a>
</li>
    
<li>
<a target="cvs" href="http://jakarta.apache.org/site/cvsindex.html">CVS</a>
</li>
    
<li>
<a href=".././participating/howto_build.html" title="How to build Cactus from source.">Building From Source</a>
</li>
    
<li>
<a href=".././participating/coverage.html" title="Cactus code coverage reports (generated by Clover)">Code Coverage Reports</a>
</li>
    
<li>
<a href=".././participating/release_checklist.html" title="Things that are important to check when preparing a release of Cactus.">Release Checklist</a>
</li>
  
</ul>
</li>

  
<li>Miscellaneous<ul>
    
<li>
<a href=".././participating/logos.html" title="Logos for Cactus proposed by various people.">Logos</a>
</li>
  
</ul>
</li>


<li>
<img src="images/cactusbanner.gif"></li>
</ul>
</div>
</td><td id="content">

  

  

    
<div class="section">
<h1>Cactus API design rules</h1>

      
<div class="note">
        Most of these rules are extracted from the excellent 
        <a href="http://www.eclipse.org/articles/Article-API%20use/eclipse-api-usage-rules.html" title="">How to Use the Eclipse API</a> article
        by Jim des Rivieres.
      </div>

      
<div class="section">
<h2>Public APIs/SPIs</h2>

        
<p>
          To try to draw the line more starkly, the code base for the platform 
          is separated into API/SPI and non-API/non-SPI packages, with all 
          API/SPI elements being declared in designated API/SPI packages.           
        </p>

        
<ul>
          
<li>
            
<b>API/SPI package</b>: a Java package that contains at 
            least one API/SPI class or API/SPI interface. The names of API/SPI
            packages are advertised in the documentation for that component; 
            where feasible, all other packages containing only implementation 
            details have "internal" in the package name. The names of API/SPI
            packages may legitimately appear in client code. For the Cactus 
            project, these are:             
          </li>

<div class="source">
<pre>
  org.apache.cactus.foo.*          - API
  org.apache.cactus.spi.foo.*      - SPI
  org.apache.cactus.internal.foo.* - not API; internal implementation packages 
  org.apache.cactus.sample.*       - not API; these are examples
</pre>
</div>
          
<li>
            
<b>API/SPI class or interface</b>: a public class or 
            interface in an API package, or a public or protected class or 
            interface member declared in, or inherited by, some other API 
            class or interface. The names of API classes and interfaces may
            legitimately appear in client code.             
          </li>
          
<li>
            
<b>API/SPI method or constructor</b>: a public or 
            protected method or constructor either declared in, or inherited
            by, an API/SPI class or interface. The names of API/SPI methods 
            may legitimately appear in client code. 
          </li>
          
<li>
            
<b>API/SPI field</b>: a public or protected field either
            declared in, or inherited by, an API/SPI class or interface. The 
            names of API/SPI fields may legitimately appear in client code.
          </li>
        
</ul>
        
<p>
          Everything else is considered internal implementation detail and off 
          limits to all clients. Legitimate client code must never reference 
          the names of non-API/non-SPI elements (not even using Java 
          reflection). In some cases, the Java language's name accessibility 
          rules are used to disallow illegal references. However, there are 
          many cases where this is simply not possible. Observing this one 
          simple rule avoids the problem completely: 
        </p>
        
<ul>
          
<li>
            Stick to officially documented APIs/SPIs. Only reference packages 
            that are documented in the published API/SPI Javadoc for the 
            component. Never reference a package belonging to another component
            that has "internal" in its name --- these are never API/SPI. Never 
            reference a package for which there is no published API/SPI Javadoc
            --- these are not API/SPI either.
          </li>
        
</ul>

      
</div>

      
<div class="section">
<h2>No public methods in internal packages</h2>

        
<p>
          In order to preserve binary compatibility, no user public API/SPI 
          must be located in internal packages.
        </p>        
        
      
</div>

      
<div class="section">
<h2>No public class exposed as much as possible</h2>

        
<p>
          Only interfaces should be exposed in the public API/SPI (as much as 
          possible). This will satisfy binary compatibility and allow future 
          extensibility. Of course, in some cases, it is not possible. For 
          example, <code>ServletTestCase</code> has to be a class as it 
          contains logic required to transform a JUnit test case into a Cactus
          test case. Same for <code>ServletTestSuite</code> as the way to use 
          it in a JUnit <code>suite()</code> method is to create an instance 
          of it.
        </p>        
        
      
</div>
      
    
</div>

  

</td>
</tr>
</table>
<div id="footer">
<p>
	    Copyright &copy; 2000-2004 The Apache Software Foundation.
            All Rights Reserved.
	  </p>
</div>
</body>
</html>
