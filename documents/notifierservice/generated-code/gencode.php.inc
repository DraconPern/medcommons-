<?PHP
//
// ***** do not edit - this code generated by notification compiler.php
// these functions replicated here rather than copying in all of dbconfig.inc

function pretty_tracking($tracking) {
	return substr($tracking,0,4)." ".substr($tracking,4,4)." ".substr($tracking,8,4);
	}
function pretty_mcid($s)
{
	return substr($s,0,4)." ".substr($s,4,4)." ".substr($s,8,4)." ".substr($s,12,4);
}
function merge_tracking_mcid($tracking,$s)
{
	return substr($s,0,4).substr($tracking,8,4).substr($s,4,4).substr($tracking,4,4).
	                                                           substr($s,8,4).substr($tracking,0,4).substr($s,12,4);
}
function unmerge_tracking_mcid($num,&$t,&$m)
{
	$m = substr($num,0,4).substr($num,8,4).substr($num,16,4).substr($num,24,4);
	$t = substr($num,20,4).substr($num,12,4).substr($num,4,4);
}

function mailwelcomemsg
( &$message,	 $mcid,
               	 $template,
               	 $recipient,
               	 $subjectline,
               	 $a,$b,$c,$d,$e,$f,$g
			)		 
				 { 
				    $trackingnum = $a; // must be first if present
				 	$homepageurl = $GLOBALS['Homepage_Url'];
		
				 	$homepagehtml= "<a href=$homepageurl>$homepageurl</a>";
				 	$trackingurl = $GLOBALS['Tracking_Url'];
				 	$prettytracking = pretty_tracking($trackingnum);
				 	$merge = merge_tracking_mcid($trackingnum,$mcid);
				 	$trackinghtml = "<a href=$trackingurl?a=$merge>$prettytracking</a>";
				 	$mcidhtml = pretty_mcid($mcid);
			 	
				 	$message = <<<XXX

		
<HTML><HEAD><TITLE>MedCommons Notification for $recipient</TITLE>
<META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
</HEAD>
<BODY>
<p><small>welcome to MedCommons - needs graphic work-------------------------------------------------------------------------------
<br></small>
<br>

Dear $a</p>

<p>Congratulations on joining MedCommons. If you have any issues, please
contact cmo@medcommons.net</p>

<p>Best regards</p>

<p>The MedCommons Team</p>

<p>$homepagehtml</p>

</BODY>
</HTML>
XXX;
/*										 
$ismail = (strpos($recipient,"@")!=false);		
if (!$ismail) {

	// all numeric email, send a fax instead
return sendfax($trackingnum,$subjectline,$recipient,base64_encode($message),"html");

}
else 
*/
	//  send real email
	{				 
$stat = @mail($recipient, $subjectline, 
		$message,
     "From: MedCommons@{$_SERVER['SERVER_NAME']}\r\n" .
     "Reply-To: cmo.medcommons.net\r\n" .
     "bcc: cmo@medcommons.net\r\n".
     "Content-Type: text/html; charset= iso-8859-1;\r\n"
     );
if($stat) return "ok"; else return "send mail failure";
}				 

}

function mailintromsg
( &$message,	 $mcid,
               	 $template,
               	 $recipient,
               	 $subjectline,
               	 $a,$b,$c,$d,$e,$f,$g
			)		 
				 { 
				    $trackingnum = $a; // must be first if present
				 	$homepageurl = $GLOBALS['Homepage_Url'];
		
				 	$homepagehtml= "<a href=$homepageurl>$homepageurl</a>";
				 	$trackingurl = $GLOBALS['Tracking_Url'];
				 	$prettytracking = pretty_tracking($trackingnum);
				 	$merge = merge_tracking_mcid($trackingnum,$mcid);
				 	$trackinghtml = "<a href=$trackingurl?a=$merge>$prettytracking</a>";
				 	$mcidhtml = pretty_mcid($mcid);
			 	
				 	$message = <<<XXX

		
<HTML><HEAD><TITLE>MedCommons Notification for $recipient</TITLE>
<META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
</HEAD>
<BODY>
<p><small>An explanation of emails to follow -------------------------------------------------------------------------------
<br></small>
<br>
Dear $recipient</p>

<p>You are about to receive a batch of emails from MedCommons. These are all the
outgoing messages that MedCommons knows how to send. They are engineered around
certain principal actors, and you will recognize these guys immediately. </p>

<p>When you click on any link in these emails, you will be challenged to log on
to MedCommons. Once you have successfully logged on the service should
immediately take you to your Desktop and perhaps into the Wado Viewer, or the
new Telegram Viewer. </p>

<p>Please let us have your comments.</p>

<p>Sincerely,</p>

<p>The MedCommons Team</p>

<p>Thank you for using MedCommons. </p>

<p>$homepagehtml</p>
</BODY>
</HTML>
XXX;
/*										 
$ismail = (strpos($recipient,"@")!=false);		
if (!$ismail) {

	// all numeric email, send a fax instead
return sendfax($trackingnum,$subjectline,$recipient,base64_encode($message),"html");

}
else 
*/
	//  send real email
	{				 
$stat = @mail($recipient, $subjectline, 
		$message,
     "From: MedCommons@{$_SERVER['SERVER_NAME']}\r\n" .
     "Reply-To: cmo.medcommons.net\r\n" .
     "bcc: cmo@medcommons.net\r\n".
     "Content-Type: text/html; charset= iso-8859-1;\r\n"
     );
if($stat) return "ok"; else return "send mail failure";
}				 

}

function mailtelldocmsg
( &$message,	 $mcid,
               	 $template,
               	 $recipient,
               	 $subjectline,
               	 $a,$b,$c,$d,$e,$f,$g
			)		 
				 { 
				    $trackingnum = $a; // must be first if present
				 	$homepageurl = $GLOBALS['Homepage_Url'];
		
				 	$homepagehtml= "<a href=$homepageurl>$homepageurl</a>";
				 	$trackingurl = $GLOBALS['Tracking_Url'];
				 	$prettytracking = pretty_tracking($trackingnum);
				 	$merge = merge_tracking_mcid($trackingnum,$mcid);
				 	$trackinghtml = "<a href=$trackingurl?a=$merge>$prettytracking</a>";
				 	$mcidhtml = pretty_mcid($mcid);
			 	
				 	$message = <<<XXX

		
<HTML><HEAD><TITLE>MedCommons Notification for $recipient</TITLE>
<META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
</HEAD>
<BODY>
<p>
<small>this is a sample for discussion only - patient to doctor secure communications </small>
-------------------------------------------------------------------------------
<br><br>

Dear Doctor $a,
<p>
Your patient $b has left a $c for you at MedCommons.
<br>
<a href=https://secure.medcommons.net/viewmessage.php?a=01&b=1111222233334440>Click here</a> to securely view this communication.
<br>
</p>
Thank you for using MedCommons.

</BODY>
</HTML>
XXX;
/*										 
$ismail = (strpos($recipient,"@")!=false);		
if (!$ismail) {

	// all numeric email, send a fax instead
return sendfax($trackingnum,$subjectline,$recipient,base64_encode($message),"html");

}
else 
*/
	//  send real email
	{				 
$stat = @mail($recipient, $subjectline, 
		$message,
     "From: MedCommons@{$_SERVER['SERVER_NAME']}\r\n" .
     "Reply-To: cmo.medcommons.net\r\n" .
     "bcc: cmo@medcommons.net\r\n".
     "Content-Type: text/html; charset= iso-8859-1;\r\n"
     );
if($stat) return "ok"; else return "send mail failure";
}				 

}

function mailtellpatientmsg
( &$message,	 $mcid,
               	 $template,
               	 $recipient,
               	 $subjectline,
               	 $a,$b,$c,$d,$e,$f,$g
			)		 
				 { 
				    $trackingnum = $a; // must be first if present
				 	$homepageurl = $GLOBALS['Homepage_Url'];
		
				 	$homepagehtml= "<a href=$homepageurl>$homepageurl</a>";
				 	$trackingurl = $GLOBALS['Tracking_Url'];
				 	$prettytracking = pretty_tracking($trackingnum);
				 	$merge = merge_tracking_mcid($trackingnum,$mcid);
				 	$trackinghtml = "<a href=$trackingurl?a=$merge>$prettytracking</a>";
				 	$mcidhtml = pretty_mcid($mcid);
			 	
				 	$message = <<<XXX

		
<HTML><HEAD><TITLE>MedCommons Notification for $recipient</TITLE>
<META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
</HEAD>
<BODY>
<p>
<small>this is a sample for discussion only - doctor to patient secure communications </small>
--------------------------------------------------------------------------------
<br><br>

Dear $a,<br>
<p>
Your doctor $b has left a $c for you at MedCommons.
<br>
<a href=https://secure.medcommons.net/viewmessage.php?a=02&b=2222333344445550>Click here</a> to securely view this communication.
<br>
</p>
Thank you for using MedCommons.

</BODY>
</HTML>
XXX;
/*										 
$ismail = (strpos($recipient,"@")!=false);		
if (!$ismail) {

	// all numeric email, send a fax instead
return sendfax($trackingnum,$subjectline,$recipient,base64_encode($message),"html");

}
else 
*/
	//  send real email
	{				 
$stat = @mail($recipient, $subjectline, 
		$message,
     "From: MedCommons@{$_SERVER['SERVER_NAME']}\r\n" .
     "Reply-To: cmo.medcommons.net\r\n" .
     "bcc: cmo@medcommons.net\r\n".
     "Content-Type: text/html; charset= iso-8859-1;\r\n"
     );
if($stat) return "ok"; else return "send mail failure";
}				 

}

function mailreferralinvitemsg
( &$message,	 $mcid,
               	 $template,
               	 $recipient,
               	 $subjectline,
               	 $a,$b,$c,$d,$e,$f,$g
			)		 
				 { 
				    $trackingnum = $a; // must be first if present
				 	$homepageurl = $GLOBALS['Homepage_Url'];
		
				 	$homepagehtml= "<a href=$homepageurl>$homepageurl</a>";
				 	$trackingurl = $GLOBALS['Tracking_Url'];
				 	$prettytracking = pretty_tracking($trackingnum);
				 	$merge = merge_tracking_mcid($trackingnum,$mcid);
				 	$trackinghtml = "<a href=$trackingurl?a=$merge>$prettytracking</a>";
				 	$mcidhtml = pretty_mcid($mcid);
			 	
				 	$message = <<<XXX

		
<HTML><HEAD><TITLE>eReferral $trackingnum</TITLE>
<META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
</HEAD>
<BODY>
<img src=http://www.medcommons.net/images/smallwhitelogo.gif />
<p>
eReferral $trackinghtml is available at MedCommons. Please click on the tracking number link to access. Be prepared to supply a PIN or a valid user registration to access patient information.
<p>
Sender Comment:
<br>
<p>
$b
<p>    
HIPAA Security and Privacy Notice: The Study referenced in this 
invitation contains Protected Health Information (PHI) covered under 
the HEALTH INSURANCE PORTABILITY AND ACCOUNTABILITY ACT OF 1996 (HIPAA).
The MedCommons user sending this invitation has set the security 
requirements for your access to this study and you may be required to 
register with MedCommons prior to viewing the PHI. Your access to this 
Study will be logged and this log will be available for review by the 
sender of this invitation and authorized security administrators. 
For more information about MedCommons privacy and security policies, 
please visit $homepagehtml
</BODY>
</HTML>
XXX;
/*										 
$ismail = (strpos($recipient,"@")!=false);		
if (!$ismail) {

	// all numeric email, send a fax instead
return sendfax($trackingnum,$subjectline,$recipient,base64_encode($message),"html");

}
else

*/
	//  send real email
	{				 
$stat = @mail($recipient, $subjectline, 
		$message,
     "From: MedCommons@{$_SERVER['SERVER_NAME']}\r\n" .
     "Reply-To: cmo.medcommons.net\r\n" .
     "bcc: cmo@medcommons.net\r\n".
     "Content-Type: text/html; charset= iso-8859-1;\r\n"
     );
if($stat) return "ok"; else return "send mail failure";
}				 

}

?>
